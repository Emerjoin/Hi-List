var hiList={};hiList.baseExtension=function(){this.$preTransform=function(a,b){},this.$beforeFilter=function(a,b,c,d){},this.$beforeDisplay=function(a,b,c){},this.$startup=function(){}},hiList.extensions={},hiList.extend=function(a){var b=new hiList.baseExtension,c=a.call({},b);if(!c.hasOwnProperty("build")||!c.hasOwnProperty("name"))throw new Error("A hiList extension should contains at least the name property and the build function");c.$newInstance=function(){if(c.hasOwnProperty("inject")){var a=c.build;return a.$inject=c.inject,angular.injector().invoke(a)}return c.build.call({})},hiList.extensions[c.name]=c},hiList.getExtension=function(a){if(!hiList.extensions.hasOwnProperty(a))throw new Error("Extension not encountered : "+a);var b=hiList.extensions[a];if(b.hasOwnProperty("singleton"))return b.hasOwnProperty("instance")?b.instance:(b.instance=b.$newInstance(),b.instance.$startup(),hiList[a]=b,b.instance);var b=b.$newInstance();return b.$startup(),b},hiList.extend(function(a){return{name:"name1",singleton:!1,build:function(){return a.$startup=function(a){console.log("I'm just a stupid extension")},a.transformRepeatable=function(a,b,c){},a.transformHtml=function(a,b,c){},a.preFetch=function(a,b){},a.postFetch=function(a,b){},a.fetchFail=function(a,b,c){},a.fetchFinished=function(a){},a.invalidResult=function(a){},a.apiSetup=function(a,b){},a}}}),hiList.html={},hiList.html.header="<div></div>",hiList.html.footer='<nav class="col-md-12 col-lg-12 col-sm-12 text-center" ng-show="!$empty"><ul class="pagination"><li><a  ng-click="goToPreviousPage()" href="#" aria-label="Previous"><span aria-hidden="true"><b translate>Previous</b></span></a></li><li ng-class=\'{"active":activePage==page}\' ng-click="activatePage(page)" ng-repeat="page in pagesVisible"><a href="#">{{page}}</a></li><li><a ng-click="goToNextPage()" href="#" aria-label="Next"><span aria-hidden="true"><b translate>Next</b></span></a></li></ul></nav>',hiList.html.empty="<h3>The list is empty for now</h3>",hiList.html.fail="<h4>The list request failed</h4>",hiList.html.delaying="<h5>The server is delaying</h5>",hiList.utils={},hiList.utils.getFrontierAction=function(url){var dotIndex=url.indexOf(".");if(dotIndex!=-1){var controller=url.substr(0,dotIndex),action=url.substr(dotIndex+1,url.length);try{var functionResolved=eval(controller+"."+action);return"function"==typeof functionResolved&&functionResolved}catch(a){return!1}}},hiList.utils.generatePagesSequence=function(a){for(var b=[],c=1;c<=a;)b.push(c),c++;return b},hiList.directive=function(a,b){var c={};return c.restrict="E",c.scope=!0,c.link=function(c,d,e){if(c.maxItemsOptions=[25,50,150,200],c.show={maxItems:25},c.activePage=1,c.ordering={empty:!0},c.activePageIndex=0,c.maxVisiblePages=6,c.pages=[],c.pagesVisible=[],c.activatePage=function(a){c.activePage=a;var b=c.activePage;if(b>1){var d=c.pagesVisible.indexOf(b);if(d==-1)c.$pages.notVisible(b);else{var e=c.pagesVisible.indexOf(c.pagesVisible[c.pagesVisible.length-1]),f=c.pages.indexOf(c.pagesVisible[c.pagesVisible.length-1]),g=c.pages.indexOf(c.pagesVisible[0]),h=c.pages.length-1,i=e/2;d>i?c.$pages.left(d,e,h,f):d<i&&c.$pages.right(d,e,g)}}c.$doFilter(a)},c.$watch("filter.text",function(a,b){c.$doFilter(1)}),c.$watch("show.maxItems",function(a,b){c.$doFilter(1)}),c.$hide={},c.$show={},c.show.maxItemsOptions=!0,c.$elements={},c.$failed=!1,c.$empty=!1,c.$delaying=!1,c.$filterInProgress=!1,c.$pages={},c.callExtensions=function(a,b){for(var d in c.$extensions){var e=c.$extensions[d];"object"==typeof e&&e.hasOwnProperty(a)&&e[a].apply(e,b)}},c.$pages.createPagesList=function(a){c.pages=hiList.utils.generatePagesSequence(a);var b=0,d=[];c.pages.forEach(function(a,e){b!=c.maxVisiblePages&&(d.push(a),b++)}),c.pagesVisible=d,c.activePage=1},c.$pages.right=function(a,b,d){var e=d-1;if(0==d);else if(0!=d){var f=c.pages[e],g=angular.copy(c.pagesVisible);g.splice(g.length-1,1),g.unshift(f),c.pagesVisible=g}},c.$pages.left=function(a,b,d,e){var f=e+1;if(d==e);else if(e!=d){var g=c.pages[f],h=angular.copy(c.pagesVisible);h.splice(0,1),h.push(g),c.pagesVisible=h}},c.$pages.notVisible=function(a){var b=0,d=1,e=!1,f=c.pages.indexOf(a),g=c.pages.length-1,h=c.maxVisiblePages;0==f?(b=f,d=1):f==g?(b=f,d=0,e=!0):c.pages.indexOf(g)==-1?(b=f+1,d=0,e=!0):(b=f-1,d=1);for(var i=0,j=[],k=b;i<h&&!(k>g||k<0);)j.push(c.pages[k]),d>0?k++:k--,i++;e&&j.reverse(),c.pagesVisible=j,c.$applyAsync()},c.$processResult=function(a){if("object"!=typeof a)return c.pagesVisible=[],c.callExtensions("invalidResult",[c]),void console.error("Invalid result returned by "+c.$attributes.name+" data source");if(!(a.hasOwnProperty("data")&&a.hasOwnProperty("totalRowsMatch")&&a.hasOwnProperty("pageNumber")&&a.hasOwnProperty("totalPagesMatch")))return c.pagesVisible=[],c.callExtensions("invalidResult",[c]),void console.error("Invalid result returned by "+c.$attributes.name+" data source");0==a.data.length||0==a.totalPagesMatch?(c.$empty=!0,c.pagesVisible=[],c.rows=[]):c.$empty=!1,c.$handlers.postFetch&&c.$handlers.postFetch(c,{result:a}),c.callExtensions("postFetch",[c,a]),c.rows=a.data,c.previousPage=c.activePage,c.activePage=a.pageNumber,c.totalPages=a.totalPagesMatch,c.totalRowsMatch=a.totalRowsMatch;var b=c.activePage;1==b&&(c.$pages.createPagesList(a.totalPagesMatch),c.activePage=1)},c.$delay=300,c.$delayTimeout=!1,c.$doFilter=function(a){c.$delayTimeout&&clearTimeout(c.$delayTimeout),c.$delayTimeout=setTimeout(function(){c.$delaying=!0,c.$applyAsync()},c.$delay),c.$failed=!1,"function"!=typeof c.$ds&&console.error("Cant proceed with filtering : invalid list data-source"),c.$filterInProgress||(c.$filterInProgress=!0);var b=c.activePage;"undefined"!=typeof a&&(b=a);var d=c.show.maxItems,e=c.ordering;c.$handlers.preFetch&&c.$handlers.preFetch(c,{filter:c.filter}),c.callExtensions("preFetch",[c,c.filter]),c.$ds.call({},b,d,c.filter,e).try(function(a){c.$processResult(a),c.activePage=b}).catch(function(a){c.$handlers.onFail&&c.$handlers.onFail(c,{err:a}),c.callExtensions("fetchFail",[c]),c.pagesVisible=[],c.$failed=!0,c.rows=[],console.error("Datasource frontier request failed for "+c.$attributes.name+".")}).finally(function(){c.callExtensions("fetchFinished",[c]),c.$delaying=!1,clearTimeout(c.$delayTimeout),c.$filterInProgress&&(c.$filterInProgress=!1),c.$apply()})},c.refresh=function(){c.activatePage(c.activePage)},c.goToPage=function(a){var b=c.pages.indexOf(a);if(b==-1)throw new Error("Invalid page number : "+a+".");c.activatePage(a)},c.goToLastPage=function(){0!=c.pages.length&&this.goToPage(c.pages[c.pages.length-1])},c.goToFirstPage=function(){c.pages.length>0&&c.goToPage(c.pages[0])},c.getCurrentPage=function(){return c.activePage},c.goToNextPage=function(){var a=c.activePage+1;c.pages.indexOf(a)!=-1&&c.goToPage(a)},c.goToPreviousPage=function(){var a=c.activePage-1;c.pages.indexOf(a)!=-1&&c.goToPage(a)},c.$extensions={},c.$extensionList=[],c.$bootExtensions=function(){var a=[];if(e.hasOwnProperty("extensions")){var b=e.extensions;a=b.split(" ")}if(a.length>0){c.$extensionList=a;for(var d in a){var f=a[d];if("string"==typeof f){var g=hiList.getExtension(f);c.$extensions[f]=g}}}},c.$bootExtensions(),!e.hasOwnProperty("name"))throw new Error("The list element should have a <name> attribute");if(!e.hasOwnProperty("repeatElement"))throw new Error("The list element should have a <repeat-element> attribute that specifies the element that should be repeated.");if(!e.hasOwnProperty("each"))throw new Error("The list element should have a <item> attribute that specifies the name to repeat");if(!e.hasOwnProperty("src"))throw new Error("The list element should have a <src> attribute that specifies the data source.");if(e.hasOwnProperty("perPage")){var f=parseInt(e.perPage);if(!isNaN(f)){if(f<=1)throw new Error("Invalid max items per page. Should be higher than 1");c.maxItemsOptions.indexOf(f)==-1&&c.maxItemsOptions.unshift(f),c.show.maxItems=f}}var g=e.src,h=hiList.utils.getFrontierAction(g);if("undefined"==typeof h)throw new Error("Invalid list data source value format : "+g);if(!h)throw new Error("Data source could not be found. Make sure it was properly created and is available : "+g);c.$ds=h;var i=e.each,j=c.$parent,k=e.name,l=e.repeatElement,m=d.find(l);if(0==m.length)throw new Error("Repeatable element could not be found using the specifiend jQuery selector : "+l);if(j.hasOwnProperty(k)&&console.warn("The list name <"+k+"> is already in use on its parent scope"),c.$attributes=e,e.hasOwnProperty("delay")){var n=e.delay;try{c.$delay=parseInt(n)}catch(a){throw new Error("Invalid delay detect time : "+n)}}if(c.filter={text:""},c.$handlers={},e.hasOwnProperty("prefetch")){var o=e.prefetch,p=b(o);c.$handlers.preFetch=p}if(e.hasOwnProperty("onfail")){var q=e.onfail,p=b(q);c.$handlers.onFail=p}if(e.hasOwnProperty("postfetch")){var o=e.postfetch,p=b(o);c.$handlers.postFetch=p}var r={repeatable:m};c.callExtensions("transformRepeatable",[c,e,r]),m=r.repeatable,m.attr("ng-repeat",i+" in rows");var s=$("<header>").addClass("row hilist-header").html(hiList.html.header);$(d).prepend(s);var t=$("<footer>").addClass("row hilist-footer").html(hiList.html.footer);$(d).append(t);var u=$(d).html();r={html:u},c.callExtensions("transformHtml",[c,e,r]),u=r.html;var v=angular.element(u),w=a(v,function(){});d.html(v),c.callExtensions("apiSetup",[c,e]),j[k]=c,w(c)},c},Hi.$ui.js.component("list",hiList.directive);